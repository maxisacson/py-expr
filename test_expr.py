import pytest
from main import parse_expression

TEST_DATA = [
    ('1+2*3', 7),
    ('(4+5)*6', 54),
    ('7-8/2+3', 6.0),
    ('10%3+6', 7),
    ('2^3^2', 512),
    ('(2^3)^2', 64),
    ('sqrt(16)+4', 8.0),
    ('sin(0)+cos(0)', 1.0),
    ('tan(45)-sin(30)', 2.6078068146367235),
    ('asin(0.5)*2', 1.0471975511965979),
    ('acos(-1)/2', 1.5707963267948966),
    ('atan(1)*4', 3.141592653589793),
    ('sqrt(sin(1)^2+cos(1)^2)', 1.0),
    ('(3+5)*(2-8)/4', -12.0),
    ('(10%4)*(6-1)', 10),
    ('sin(cos(tan(0.5)))', 0.7542107560326126),
    ('sqrt((3+4)^2-(5-2)^2)', 6.324555320336759),
    ('(2+3*(4-1))/(5-3)', 5.5),
    ('sin(asin(0.25))+cos(acos(0.25))', 0.5),
    ('((1+2+3)/4)^(sqrt(9)-1)', 2.25),
    ('1+2+3+4+5', 15),
    ('1*2*3*4*5', 120),
    ('100/5/2', 10.0),
    ('100%(3+2)', 0),
    ('(8-3-1)', 4),
    ('(8-(3-1))', 6),
    ('((((5))))', 5),
    ('(1+(2*(3+(4*(5)))))', 47),
    ('3^3^3', 7625597484987),
    ('(3^3)^3', 19683),
    ('(2^(2^3))', 256),
    ('2^2^2^2', 65536),
    ('sin(1+2)*cos(3+4)', 0.10639069220927921),
    ('tan(sin(0.4)+cos(0.3))', 4.348361409540323),
    ('sqrt(sqrt(256))', 4.0),
    ('sqrt(2+sqrt(3+sqrt(5)))', 2.07080796098304),
    ('(1+2)/(3+4)/(5+6)', 0.03896103896103896),
    ('(1/(2/(3/(4/5))))', 1.875),
    ('(5*(4+(3*(2+1))))', 65),
    ('sin(asin(sin(asin(0.2))))', 0.2),
    ('cos(acos(cos(1)))', 0.5403023058681398),
    ('tan(atan(1))+atan(tan(1))', 2.0),
    ('sin(1)^cos(2)', 1.074471059683863),
    ('(3+4)%(5+6)', 7),
    ('10%(3%2)', 0),
    ('(10%3)%2', 1),
    ('10%(3%2%1+1)', 0),
    ('sqrt(49)%5', 2.0),
    ('(7%4)^2', 9),
    ('((9%5)*(8%3))', 8),
    ('(1+2)*(3+4)*(5+6)', 231),
    ('(1*2)+(3*4)+(5*6)', 44),
    ('1-(2-(3-(4-(5))))', 3),
    ('((((1+2)*3)-4)/5)', 1.0),
    ('(((((2)))))+3', 5),
    ('sqrt(25)+sqrt(36)-sqrt(49)', 4.0),
    ('sin(3.14159/2)', 0.9999999999991198),
    ('cos(3.14159)', -0.9999999999964793),
    ('tan(3.14159/4)', 0.9999986732059836),
    ('asin(1/2)+acos(1/2)', 1.5707963267948968),
    ('atan(1)+atan(2)', 1.8925468811915387),
    ('sqrt((1+2+3+4)^2)', 10.0),
    ('((1+2)^3)^2', 729),
    ('(1+2)^(3^2)', 19683),
    ('1^(2^3)', 1),
    ('(0^1)+(1^0)', 1),
    ('((sin(1)+cos(2))*(tan(3)+sqrt(4)))', 0.7900198095009261),
    ('sqrt(sin(2)^2+cos(2)^2)', 1.0),
    ('sin(2)^2+cos(2)^2', 1.0),
    ('(1+2)*(3-4)/(5-6)*(7-8)', -3.0),
    ('sin((cos((tan(1)))))', 0.013387802193205699),
    ('asin(acos(atan(1.0)))', 0.7307887932612706),
    ('((((sin(1)*cos(1))*tan(1))))', 0.7080734182735713),
    ('sqrt((sqrt((sqrt(81)))))', 1.7320508075688772),
    ('(1+2*(3+4*(5+6*(7+8))))', 767),
    ('(9-(8-(7-(6-(5-(4-(3-(2-1))))))))', 5),
    ('((3%2)+(4%3)+(5%4))', 3),
    ('((3%2)*(4%3)*(5%4))', 1),
    ('(100/(5*5))*((3+2)-1)', 16.0),
    ('(3*3*3)/(3+3)', 4.5),
    ('sqrt(2)^sqrt(3)', 1.8226346549662424),
    ('2^(sqrt(2)+sqrt(3))', 8.85360107441145),
    ('((2^3)*(3^2))/(4^1)', 18.0),
    ('(1+2+3+4+5+6+7+8+9)%7', 3),
    ('(50%7)*((30%5)+(20%3))', 2),
    ('sin(1+2+3+4)', -0.5440211108893698),
    ('cos(1*2*3*4)', 0.424179007336997),
    ('tan(1/2/3)', 0.16822721830224246),
    ('sqrt(1/2/3)', 0.408248290463863),
    ('asin(0.1+0.2)', 0.3046926540153976),
    ('acos(0.3-0.1)', 1.369438406004566),
    ('atan(0.5*2)', 0.7853981633974483),
    ('1+(2*(3^(4-(5/(6+7)))))', 107.1712277843317),
    ('((sin(1)+2)^(cos(1)+3))', 40.33482041837844),
    ('(((1+2)*(3+4))^(2+1))', 9261),
    ('(2^(2^(2^(1))))', 16),
    ('(((((3+3)*2)-1)%5)^2)', 1),
    ('sqrt((3+5)*(7+11))', 12.0),
    ('sin(sqrt(2))*cos(sqrt(3))', -0.15859228121054833),
    ('tan(sin(0.2*cos(0.3)))', 0.19222327319081378),
    ('(2+3)%(4+5*0+1)', 0),
    ('((9/3)/(3/1))', 1.0),
    ('((4/(1+1))/(1+1))', 1.0),
    ('(7*6)/(5*4)/(3*2)', 0.35000000000000003),
    ('1%2%3%4', 1),
    ('(((1%2)%3)%4)', 1),
    ('(10%6)+(10%4)+(10%3)', 7),
    ('sqrt(9)+sin(1)-cos(2)+tan(3)', 4.1150712782807615),
    ('asin(sin(0.75+0.25))', 1.0),
    ('acos(cos(1-0.5))', 0.4999999999999999),
    ('atan(tan(1*0.5))', 0.5),
]


@pytest.mark.parametrize("expression, expected", TEST_DATA)
def test_expr(expression, expected):
    e = parse_expression(expression)
    actual = e.eval()

    assert actual == expected
